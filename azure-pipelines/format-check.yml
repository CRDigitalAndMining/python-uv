# Code Formatting Check Pipeline
# Equivalent to .github/workflows/format.yml

trigger:
  branches:
    include:
      - main
  paths:
    include:
      - "**.py"
      - ".python-version"
      - "pyproject.toml"
      - "ruff.toml"
      - "uv.lock"
      - "azure-pipelines/format-check.yml"

pr:
  branches:
    include:
      - main
  paths:
    include:
      - "**.py"
      - ".python-version"
      - "pyproject.toml"
      - "ruff.toml"
      - "uv.lock"
      - "azure-pipelines/format-check.yml"

pool:
  vmImage: "ubuntu-latest"

jobs:
  - job: RuffFormat
    displayName: "Check Code Formatting with Ruff"
    steps:
      - checkout: self

      - script: |
          curl -LsSf https://astral.sh/uv/install.sh | sh
          echo "##vso[task.prependpath]$HOME/.cargo/bin"
        displayName: "Install uv"

      - script: |
          uv sync --frozen
        displayName: "Install dependencies with uv"

      - script: |
          uv run nox -s fmt
        displayName: "Run Ruff Format Check"
